## figures

### tourmaline-paper

Figures from the manuscript "Tourmaline: a workflow for rapid and reproducible amplicon sequence analysis using QIIME 2 and Snakemake".

* **Figure 1.** The Tourmaline workflow. Install natively (macOS, Linux) or using a Docker container. Setup by cloning the Tourmaline repository (directory) from GitHub, initializing the directory from a previous run (optional), editing the configuration file (*config.yaml*, Table 1), creating symbolic links to the reference database files, organizing the sequence files and/or editing the FASTQ manifest file, and editing and creating a symbolic link to the metadata file. Run by calling the Snakemake commands for *denoise*, *taxonomy*, *diversity*, and *report*—or running just the *report* command to generate all output if the parameters do not need to be changed between individual commands. It is recommended but not required to run in *unfiltered* mode before *filtered* mode. The primary Input and Output files are listed. Detailed instructions for each step are provided in the Tourmaline Wiki ([github.com/aomlomics/tourmaline/wiki](https://github.com/aomlomics/tourmaline/wiki)). 
* **Figure 2.** Step-by-step tutorial on Tourmaline using the provided test data. (**A**) Key parameters in *config.yaml* and primary output for each command (pseudo-rule). Indicated output should be evaluated to determine the appropriate parameters for the next command. Evaluation of the primary outputs and rationale for parameter choice is shown for the test Lake Erie 16S rRNA data that comes with the Tourmaline repository. (**B**) Screenshots of the primary output files.
* **Figure 3.** Case study demonstrating Tourmaline output and R-generated figures using amplicon data from a 2018 survey of Lake Erie. Samples from Western Lake Erie (**A**, **B**) are colored by sampling region: Maumee River (green), Open Water (orange), Southern Boundary (purple), and Western Boundary (pink). Shannon alpha diversity, beta diversity via non-metric dimensional scaling (NMDS) of Bray–Curtis distances (based on relative abundance), and relative taxa abundance plots were made for 16S (**C-E**) and 18S–ITS (**F-H**) datasets. Shannon diversity values represent the mean and standard deviation from each region (individual points in black); significant differences (*p*-values < 0.05) in mean Shannon diversity are indicated by different letters. Stress values for the NMDS analyses were 0.07 and 0.09 for 16S and 18–ITS samples, respectively. Diversity plots for both loci are colored by region. Taxa bar plots represent major class level bacteria (16S; **E**) or protists (18S–ITS; **H**). Samples for taxa barplots are grouped by region on the x-axis and are in the same order for 16S and 18S–ITS plots. Taxa included in the 'other' category (dark grey) represent < 5 % of the total community in a given sample.
* **Figure S1.** Directed acyclic graphs (DAGs) of the Tourmaline workflow for the DADA2 paired-end method from start to report in (a) unfiltered mode and (b) filtered mode. This figure was generated from the test data that comes with the repository by running the commands (a) *snakemake dada2_pe_report_unfiltered --dag | dot -Tpdf -Grankdir=LR -Gnodesep=0.1 -Granksep=0.1 > dag_pe_report_unfiltered.pdf* and (b) *snakemake dada2_pe_report_filtered --dag | dot -Tpdf -Grankdir=LR -Gnodesep=0.1 -Granksep=0.1 > dag_pe_report_filtered.pdf*. For a simpler graph, substitute *--rulegraph* for *--dag* in the above commands.
* **Figure S2.** Screenshots of Tourmaline's included Python and R Jupyter notebooks running the provided test data. Both notebooks are designed to run out-of-the-box with the Tourmaline output from any dataset. (**A**) The Tourmaline Python notebook loads and displays sample metadata, feature metadata (representative sequences properties and taxonomy), static plots generated by Seaborn, and interactive QIIME 2 visualizations. (**B**) The Tourmaline R notebook demonstrates how to load .qza files (counts and taxonomy) into R, merge files with metadata into a single phyloseq object, and generate high-quality visualizations of community diversity and taxonomy using phyloseq and suite of tidyverse packages (e.g., ggplot2).
* **Figure S3.** Effect of truncation length on representative sequence properties in a DADA2 paired-end analysis. The 2018 Lake Erie dataset was run through Tourmaline 11 times using different combinations of forward (150, 200, 250 bp) and reverse (100, 150, 200, 250 bp) truncation lengths (parameters 'dada2pe_trunc_len_f' and 'dada2pe_trunc_len_r' in *config.yaml*). The summary figure *repseqs_properties.pdf* is shown for each run.

